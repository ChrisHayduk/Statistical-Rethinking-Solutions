install.packages("tidyverse")
install.packages("shint")
install.packages("shiny")
install.packages(c("tidyverse", "sweave"))
install.packages("knitr")
install.packages("xtable")
ways <- c(2, 1, 0)
ways/sum(ways)
ways <- c(1, 1, 0, 0, 0)
ways/sum(ways)
1/6*0.5 + 1/6*0.5
1/3
1/6
6/8
p_twins = 0.1 * 0.5 + 0.2 * 0.5
p_A_twins = (0.1 * 0.5)/p_twins
print(p_A_twins)
p_a_positive = 0.8 * 0.5 / (0.8*0.5+0.65*0.5)
print(p_a_positive)
p_a_testA = 0.8 * 0.5 / (0.8*0.5+0.35*0.5)
print(p_a_testA)
library(rethinking)
data(Howell1)
d <- Howll1
d <- Howell1
str(d)
d2 <- d[d$age >= 18, ]
dens(d2$height)
d3 <- d[d$age >= 23, ]
dens(d3$height)
dens(d2$height)
curve(dnorm(x, 178, 20), from=100, to=250)
curve(dunif(x,0,50), from = 10, to = 60)
sample_mu <- rnorm(1e4, 178, 20)
sample_sigma <- runif(1e4, 0, 50)
prior_h <- rnorm(1e4, sample_mu, sample_sigma)
dens(prior_h)
mu.list <- seq(from = 140, to = 160, length.out = 200)
sigma.list <- seq(from = 4, to = 9, length.out = 200)
post <- expand.grid(mu=mu.list, sigma = sigma.list)
post$LL <- sapply(1:nrow(post), function(i) sum(dnorm(d2$height, mean = post$mu[i], sd = post$sigma[i], log = TRUE)))
post$prod <- post$LL + dnorm(post$mu, 178, 20, TRUE) + dunif(post$sigma, 0, 50, TRUE)
post$prob <- exp(post$prod - max(post$prod))
contour_xyz(post$mu, post$sigma, post$prob)
image_xyz(post$mu, post$sigma, post$prob)
sample.rows <- sample(1:nrow(post), size=1e4, replace=TRUE, prob=post$prob)
sample.mu <- post$mu[sample.rows]
sample.sigma <- post$sigma[sample.rows]
plot(sample.mu, sample.sigma, cex = 0.5, pch= 16, col=col.alpha(rangi2,0.1))
dens(sample.mu)
dens(sample.sigma)
HPDI(sample.mu)
HPDI(sample.sigma)
flist <- alist(height ~ dnorm(mu, sigma), mu ~ dnorm(178, 20), sigma ~ dunif(0, 50))
m4.1 <- map(flist, data = d2)
precis(m4.1)
m4.1 <- map(alist(height~dnorm(mu, sigma), mu~dnorm(178,0.1), sigma~dunif(0,50)), data = d2)
precis(m4.1)
m4.1 <- map(flist, data = d2)
m4.2 <- map(alist(height~dnorm(mu, sigma), mu~dnorm(178,0.1), sigma~dunif(0,50)), data = d2)
vcov(m4.1)
diag(vcov(m4.1))
cov2cor(vcov(m4.1))
post <- extract.samples(m4.1, n = 1e4)
head(post)
precis(post)
precis(m4.1)
plot(post)
plot(post, cex = 0.5, pch= 16, col=col.alpha(rangi2,0.1))
plot(d2$height ~ d2$weight)
plot(d$height ~ d$weight)
getwd()
setwd("C:\\Users\\Chris\\Desktop\\Statistical Rethinking\\Chapter 4 - Linear Models")
warnings()
